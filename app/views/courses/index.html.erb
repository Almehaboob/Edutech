<p style="color: green"><%= notice %></p>

<% content_for :title, "Courses" %>

<h1 class="text-center mb-4">Courses</h1>

<!-- Search Form -->
<div class="row justify-content-center mb-4">
  <div class="col-md-10">
    <%= search_form_for @ransack_courses, as: :courses_search, url: @ransack_path, html: { class: 'form-inline justify-content-center bg-light p-3 rounded shadow-sm' } do |f| %>
      
      <div class="form-group mx-2">
        <%= f.label :title, 'Course Title' %>
        <%= f.search_field :title_cont, placeholder: 'Course Title', class: 'form-control form-control-sm' %>
      </div>

      <div class="form-group mx-2">
        <%= f.label :short_description, 'Description' %>
        <%= f.search_field :short_description_cont, placeholder: 'Description', class: 'form-control form-control-sm' %>
      </div>

      <div class="form-group mx-2">
        <%= f.label :language, 'Languages' %>
        <%= f.search_field :languaes_cont, placeholder: 'Languages', class: 'form-control form-control-sm' %>
      </div>

      <div class="form-group mx-2">
        <%= f.label :level, 'Level' %>
        <%= f.search_field :level_cont, placeholder: 'Level', class: 'form-control form-control-sm' %>
      </div>

      <div class="form-group mx-2">
        <%= f.label :price, 'Price' %>
        <%= f.search_field :price_eq, placeholder: 'Price', class: 'form-control form-control-sm' %>
      </div>

      <div class="form-group mx-2">
        <%= f.label :user_email, 'Teacher Email' %>
        <%= f.search_field :user_email_cont, placeholder: 'Teacher Email', class: 'form-control form-control-sm' %>
      </div>

      <div class="d-flex justify-content-between">
        <%= f.submit 'Search', class: 'btn btn-success btn-sm m-2 ml-5' %>
        <%= link_to 'Refresh', courses_path, class: 'btn btn-secondary btn-sm m-2 ml-5' %>
        <%= link_to 'Add Course', new_course_path, class: 'btn btn-dark btn-sm m-2' %>
      </div>
      
    <% end %>
  </div>
</div>


<!-- Display Courses -->
<div class="row">
  <% @courses.each do |course| %>
    <div class="col-lg-3 col-md-4 col-sm-6 mb-4 d-flex align-items-stretch">
      <div class="card border-0 shadow-sm" style="width: 100%; min-height: 250px;">
        <div class="card-header bg-secondary text-white p-2 text-center" style="font-size: 0.9rem;">
          <strong><%= truncate(course.title, length: 25) %></strong>
        </div>
        <div class="card-body p-3" style="font-size: 0.85rem;">
          <p class="text-muted" style="height: 60px; overflow: hidden;">
            <%= truncate(course.description.to_plain_text, length: 100) %>
          </p>
          <p class="mb-2">
            <i class="fa fa-user"></i> <%= course.user.email %>
          </p>

          <% if course.languaes.present? %>
            <p class="mb-1">
              <i class="fa fa-language"></i> <strong>Languages:</strong> <%= course.languaes %>
            </p>
          <% end %>

          <% if course.level.present? %>
            <p class="mb-1">
              <i class="fa fa-cogs"></i> <strong>Level:</strong> <%= course.level %>
            </p>
          <% end %>

          <% if course.price.present? %>
            <p>
              <i class="fa fa-dollar-sign"></i> <strong>Price:</strong> <%= number_to_currency(course.price) %>
            </p>
          <% end %>
        </div>
        <div class="card-footer p-2 d-flex justify-content-between">
          <%= link_to "Show", course, class: "btn btn-sm btn-outline-secondary" %>
          <%= link_to "Edit", edit_course_path(course), class: "btn btn-sm btn-outline-warning" %>
          <%= link_to "Destroy", course, method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-sm btn-outline-danger" %>
        </div>
      </div>
    </div>
  <% end %>
</div>
<% pagy_bootstrap_nav(@pagy) %>
